<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Argilo â€¢ Each </title>
</head>

<body>
    <a href="../index.html">Back</a>
    <br/>
</body>
<script src="../dist/argilo.js"></script>
<script id="tpl/main.html" type="text/template">
    <div>
        Size:
        <input type="text" ag-input="scope.size" ag-value="#size" />
        <br/>
        <button ag-onclick="render">Render</button>
        <button ag-onclick="append">Append</button>
        <button ag-onclick="update">Update</button>
        <div ag-each="log in scope.logs" ag-text="log" />
    </div>
</script>
<script id="tpl/each.html" type="text/template">
    <div style="padding:10px">
        <div ag-each="item, idx in scope.coll" ag-class="input">
            <span ag-text="idx"></span>:::<span ag-text="item.title"></span>
        </div>
    </div>
</script>

<script type="text/javascript">
argilo.ready(function() {
    var each = argilo({
            template: document.getElementById('tpl/each.html').innerHTML
        }).compile({
            coll: []
        }),
        collector = argilo({
            template: document.getElementById('tpl/main.html').innerHTML,
            collector: {
                render: function() {
                    var coll = [],
                      d = new Date().toLocaleTimeString()
                    for (var i = 0; i < this.scope.size; i++) {
                        coll.push({
                            title: 'render('+d+') - ' + i
                        })
                    }
                    each.scope.coll = coll
                },
                append: function() {
                    var coll = each.scope.coll,
                      d = new Date().toLocaleTimeString()
                    for (var i = 0; i < this.scope.size; i++) {
                        coll.push({
                            title: 'append('+d+') - ' + i
                        })
                    }
                    each.scope.coll = coll
                },
                update: function() {
                    var coll = each.scope.coll,
                      d = new Date().toLocaleTimeString()
                    for (var i = 0; i < this.scope.size && i<coll.length; i++) {
                        coll[i].title = 'update('+d+') - ' + i
                    }
                    each.scope.coll = coll
                }
            }
        }).compile({
            logs: [],
            size: 100
        })
    collector.appendTo(document.body)
    each.appendTo(document.body)
});
</script>
</html>
